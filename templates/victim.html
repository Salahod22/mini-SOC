{% extends 'base.html' %}

{% block content %}
<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

    <!-- Left Column: Alerts -->
    <div class="lg:col-span-1">
        <h2 class="text-2xl font-bold text-blue-400 mb-6 flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            Active Alerts
        </h2>

        {% if threats %}
        <div class="space-y-4">
            {% for threat in threats %}
            <div class="bg-red-900/40 border border-red-500/50 p-4 rounded-lg shadow-lg">
                <h3 class="text-lg font-bold text-red-300 flex items-center">
                    <span class="w-2 h-2 bg-red-500 rounded-full mr-2 animate-pulse"></span>
                    {{ threat.type }}
                </h3>
                <p class="text-red-200/70 text-sm mt-1">{{ threat.details }}</p>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="bg-emerald-900/20 border border-emerald-500/30 p-6 rounded-lg text-center">
            <p class="text-emerald-400 font-semibold">System Secure</p>
            <p class="text-emerald-500/60 text-sm">No active threats detected.</p>
        </div>
        {% endif %}

        <div class="mt-8 bg-slate-800 p-6 rounded-lg border border-slate-700">
            <h3 class="text-lg font-semibold mb-2">System Status</h3>
            <div class="flex justify-between text-sm py-2 border-b border-slate-700">
                <span class="text-slate-400">Target IP</span>
                <span class="font-mono text-blue-300">192.168.1.100</span>
            </div>
            <div class="flex justify-between text-sm py-2 border-b border-slate-700">
                <span class="text-slate-400">IDS Status</span>
                <span class="text-emerald-400">Active</span>
            </div>
            <div class="flex justify-between text-sm py-2">
                <span class="text-slate-400">Log Entries</span>
                <span class="text-white">{{ logs|length }} (Displayed: 50)</span>
            </div>
        </div>
    </div>

    <!-- Right Column: Logs -->
    <div class="lg:col-span-2">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold text-white">Live Network Traffic</h2>
            <button onclick="window.location.reload()"
                class="text-sm bg-slate-700 hover:bg-slate-600 px-3 py-1 rounded text-slate-300 transition">
                Refresh Logs
            </button>
        </div>

        <div class="bg-slate-800 rounded-xl overflow-hidden border border-slate-700 shadow-xl">
            <div class="overflow-x-auto">
                <table class="w-full text-left text-sm">
                    <thead class="bg-slate-900 text-slate-400">
                        <tr>
                            <th class="p-4 font-semibold">Timestamp</th>
                            <th class="p-4 font-semibold">Source</th>
                            <th class="p-4 font-semibold">Action</th>
                            <th class="p-4 font-semibold">Details</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-slate-700">
                        {% for log in logs %}
                        <tr class="hover:bg-slate-700/50 transition duration-150">
                            <td class="p-3 font-mono text-slate-500 text-xs">{{ log.timestamp }}</td>
                            <td class="p-3 font-mono text-blue-300">{{ log.source_ip }}</td>
                            <td class="p-3">
                                {% if log.action == 'SCAN_SYN' %}
                                <span
                                    class="px-2 py-1 bg-yellow-900/50 text-yellow-400 rounded text-xs border border-yellow-700/50">SCAN</span>
                                {% elif log.action == 'LOGIN_ATTEMPT' %}
                                <span
                                    class="px-2 py-1 bg-red-900/50 text-red-400 rounded text-xs border border-red-700/50">AUTH</span>
                                {% elif log.action == 'HTTP_REQUEST' %}
                                <span
                                    class="px-2 py-1 bg-purple-900/50 text-purple-400 rounded text-xs border border-purple-700/50">HTTP</span>
                                {% else %}
                                <span class="px-2 py-1 bg-slate-700 text-slate-300 rounded text-xs">{{ log.action
                                    }}</span>
                                {% endif %}
                            </td>
                            <td class="p-3 text-slate-300">{{ log.details }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
{% endblock %}